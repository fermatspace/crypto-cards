-- CONSIDER WHICH OBJECTS ARE EXPORTED
module Cryptography where

import Prelude 
import Crypto.PubKey.DH hiding (generatePublic)
import Crypto.PubKey.ElGamal
import Crypto.Random
import Cards
import Crypto.Number.Serialize

-- | A 2048 bit safe prime generated via generateSafePrime in the Crypto.Number.Prime module of the cryptonite package
safePrime2048 :: Integer
safePrime2048 = 26006645102793338807810923612989518151059133495728528399856510483777587007725527731951314116559668014818408287975263610058208931047892984153732691376729763098774953813179394604392969194221987615757898295861427793216864423559379795549846279654373675127301030359938889707141315250209058067316369812482516816670530958133285155932461418550596015726080901922506759608859148980083036852159637160987343168023134537117474143592314732823789956937931848225695975318787212025703794117780049327954942307756693745501145692227764358472601348237313084601085592846113941365237097934286083838276351628649508719697565238352288988335987

-- | Define a set of DH parameters. Since p is a safe prime g is also a prime. Thus by sylow theorem the subgroup of order 2g has no small subgroups. Any game can be initiated with a given safeprime bit size given generateParams from the Crypto.Pubkey.DH module. 
unsafeParams :: Params
unsafeParams = Params p g 2048
        where 
                p = safePrime2048
                g = (safePrime2048 -1) `div` 2

combinePubKeys :: Params -> PublicNumber -> PublicNumber -> PublicNumber
combinePubKeys params@(Params p _ _) (PublicNumber a) (PublicNumber b) = PublicNumber c
        where c = (a * b) `mod` p

unitPubKey :: PublicNumber
unitPubKey = PublicNumber 1

combinePubKeysList :: Params -> [PublicNumber] -> PublicNumber
combinePubKeysList params xs = foldr (combinePubKeys params) unitPubKey xs


















--------------------------------------------------- FOR TESTING ONLY -----------------------------------------
-- | Test private key, DO NOT USE IN PRODUCTION!
unsafePrivKey1 :: PrivateNumber
unsafePrivKey1 = PrivateNumber 7324518257896898694655462528764761054197491034139974783099434315152880335765683620626882402716140641737260042056554985491820418390624859994825803297074696147574295347736205744058211112936193372247366134193578254455517250936861544124828310911827813604969128003930772934056954378529199756973988314373902385042047400108382854630634536024761663954785994640452725636064428519338768350654782983254874047995769035656117688471421138598391723420332475848578903548658473468121012364579372945637476764631725300753725785247650422348661788361132307350580310768220544121397232546348196566329961408018410546534517962149085672017932

-- | Test private key, DO NOT USE IN PRODUCTION!
unsafePrivKey2 :: PrivateNumber
unsafePrivKey2 = PrivateNumber 24762280631081513170313743119215975393182183081044074911706445661377422187430778091138497486131517082244327862914220018907905138284453623527119100501210414992746925742936049201551056493531522921320218983020312873612360032425627481528486958870959073710211430462452090018953300772987051821906070283531903183815067902327145862242387826663094494680117916846195235901491651800312835506280156289758986189792301089485931473970708855034177819076466858648887225584463781930095741032608741654834471698594362637023537929915602279116691779495597634128800581547124834136041846086881785201707529260863480758352454578611513064280887

-- | Test private key, DO NOT USE IN PRODUCTION!
unsafePrivKey3 :: PrivateNumber
unsafePrivKey3 = PrivateNumber 20897103597674883191997011990355892823900332310937052948567896997721020056606063619650440641280763924208351549152964916566477857195206862772670034568616747378320199856433863531799712714837969448630788064760336543305462261848189861501445800190986560757426377114540481926368454922183137200440215940424053484063881606861524357665060585076149952036984190814850685204422930293523267148671808408471826808788643532692680966654988019925572476582366525108917138234556536732240709875997845550042373450974292855284848170734693993815707096556881026692823424837783028249166846324002415839046684644886339864675147609139150383435922

-- | Associates test public key. DO NOT USE IN PRODUCTION!
unsafePubKey1 :: PublicNumber
unsafePubKey1 = generatePublic unsafeParams unsafePrivKey1

-- | Associates test public key. DO NOT USE IN PRODUCTION!
unsafePubKey2 :: PublicNumber
unsafePubKey2 = generatePublic unsafeParams unsafePrivKey2

-- | Associates test public key. DO NOT USE IN PRODUCTION!
unsafePubKey3 :: PublicNumber
unsafePubKey3 = generatePublic unsafeParams unsafePrivKey3
